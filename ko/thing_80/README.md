# 부수적 동작이 아닌 필요한 동작을 테스트하라

테스트에서 흔한 함정은 구현이 수행하는 것이 정확히 테스트하고자 하는 것이라고 가정하는 것입니다. 첫눈에 이것은 함정보다는 미덕처럼 들립니다. 하지만 다른 방식으로 표현하면 문제가 더 명백해집니다: 테스트에서 흔한 함정은 구현의 세부사항에 테스트를 고정시키는 것인데, 그 세부사항들이 부수적이고 원하는 기능과 관련이 없는 경우입니다.

테스트가 구현의 부수적 사항들에 고정되면, 실제로는 필요한 동작과 호환되는 구현 변경이 테스트 실패를 야기하여 거짓 양성을 초래할 수 있습니다. 프로그래머들은 일반적으로 테스트를 다시 작성하거나 코드를 다시 작성함으로써 응답합니다. 거짓 양성이 실제로 참 양성이라고 가정하는 것은 종종 두려움, 불확실성, 또는 의심의 결과입니다. 이것은 부수적 동작의 지위를 필요한 동작으로 올리는 효과가 있습니다. 테스트를 다시 작성할 때, 프로그래머들은 테스트를 필요한 동작에 다시 집중시키거나(좋음) 아니면 단순히 새로운 구현에 고정시킵니다(좋지 않음). 테스트들은 충분히 정확해야 하지만, 정확하기도 해야 합니다.

예를 들어, C의 `strcmp`나 Java의 `String.compareTo` 같은 3방향 비교에서, 결과에 대한 요구사항은 왼쪽이 오른쪽보다 작으면 음수, 왼쪽이 오른쪽보다 크면 양수, 그리고 같다고 간주되면 0이라는 것입니다. 이런 스타일의 비교는 C의 `qsort` 함수용 비교자와 Java의 `Comparable` 인터페이스의 `compareTo`를 포함한 많은 API에서 사용됩니다. 특정 값 `-1`과 `+1`이 구현에서 각각 *작음*과 *큼*을 나타내기 위해 일반적으로 사용되지만, 프로그래머들은 종종 이 값들이 실제 요구사항을 나타낸다고 잘못 가정하고 결과적으로 이 가정을 공개적으로 못박는 테스트를 작성합니다.

비슷한 문제가 간격, 정확한 표현, 그리고 부수적인 텍스트 포맷팅과 표현의 다른 측면들을 주장하는 테스트들에서 발생합니다. 예를 들어, 구성 가능한 포맷팅을 제공하는 XML 생성기를 작성하는 것이 아니라면, 간격은 결과에 중요하지 않아야 합니다. 마찬가지로, UI 컨트롤에서 버튼과 레이블의 배치를 고정시키는 것은 미래에 이런 부수적 사항들을 변경하고 정제할 옵션을 줄입니다. 구현의 사소한 변경과 포맷팅의 중요하지 않은 변경이 갑자기 빌드 중단기가 됩니다.

과도하게 명시된 테스트들은 종종 단위 테스트에 대한 화이트박스 접근법의 문제입니다. 화이트박스 테스트는 필요한 테스트 케이스를 결정하기 위해 코드의 구조를 사용합니다. 화이트박스 테스트의 전형적인 실패 모드는 테스트들이 결국 코드가 코드가 하는 일을 한다고 주장하게 되는 것입니다. 코드에서 이미 명백한 것을 단순히 다시 말하는 것은 아무런 가치를 추가하지 않고 잘못된 진전감과 안전감을 초래합니다.

효과적이 되려면, 테스트들은 구현을 앵무새처럼 따라하기보다는 계약 의무를 명시해야 합니다. 그들은 테스트 대상 단위들에 대한 블랙박스 관점을 취하여 인터페이스 계약들을 실행 가능한 형태로 스케치해야 합니다. 따라서 테스트된 동작을 필요한 동작과 일치시키세요.

[Kevlin Henney](http://programmer.97things.oreilly.com/wiki/index.php/Kevlin_Henney)가 작성함.