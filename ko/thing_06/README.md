# 리팩터링하기 전에

언젠가 모든 프로그래머는 기존 코드를 리팩터링해야 할 때가 옵니다. 하지만 그렇게 하기 전에 다음 사항들을 고려해 보세요. 이는 당신과 다른 사람들의 시간(그리고 고통)을 크게 절약해 줄 수 있습니다:

- *재구조화를 위한 최선의 접근법은 기존 코드베이스와 그 코드에 대해 작성된 테스트를 파악하는 것부터 시작됩니다.* 이는 현재 코드의 강점과 약점을 이해하는 데 도움이 되어, 강점은 유지하면서 실수는 피할 수 있게 해줍니다. 우리 모두는 기존 시스템보다 더 잘할 수 있다고 생각합니다... 하지만 기존 시스템의 실수로부터 배우지 못해서 이전 버전보다 나을 것 없거나 심지어 더 나쁜 결과물을 만들어내게 될 때까지 말이죠.

- *모든 것을 다시 작성하고 싶은 유혹을 피하세요.* 가능한 한 많은 코드를 재사용하는 것이 최선입니다. 아무리 추한 코드라도, 이미 테스트되고 검토되었습니다. 기존 코드를 버리는 것 — 특히 그것이 운영 환경에 있었다면 — 은 당신이 알지 못하는 특정 우회 방법과 버그 수정이 포함된 수개월(또는 수년)간의 테스트되고 실전에서 검증된 코드를 버리는 것을 의미합니다. 이를 고려하지 않으면, 당신이 작성하는 새 코드가 기존 코드에서 수정되었던 동일한 신비로운 버그들을 다시 보여줄 수 있습니다. 이는 수년간 얻어온 많은 시간, 노력, 그리고 지식을 낭비하게 될 것입니다.

- *하나의 거대한 변경보다는 많은 점진적 변경이 더 좋습니다.* 점진적 변경은 테스트와 같은 피드백을 통해 시스템에 미치는 영향을 더 쉽게 측정할 수 있게 해줍니다. 변경을 한 후 백 개의 테스트 실패를 보는 것은 재미없는 일입니다. 이는 좌절감과 압박으로 이어져 결국 나쁜 결정을 초래할 수 있습니다. 몇 개의 테스트 실패는 다루기 쉽고 더 관리하기 쉬운 접근법을 제공합니다.

- *각 이터레이션 후에는 기존 테스트가 통과하는지 확인하는 것이 중요합니다.* 기존 테스트가 당신이 만든 변경사항을 충분히 커버하지 못한다면 새로운 테스트를 추가하세요. 신중한 고려 없이 기존 코드의 테스트를 버리지 마세요. 표면적으로는 이런 테스트들 중 일부가 당신의 새로운 설계에 적용되지 않는 것처럼 보일 수 있지만, 이 특정 테스트가 왜 추가되었는지에 대한 이유를 깊이 파고드는 노력을 기울일 가치가 있습니다.

- *개인적 선호와 자아가 방해가 되어서는 안 됩니다.* 뭔가 망가지지 않았다면, 왜 고치려고 할까요? 코드의 스타일이나 구조가 당신의 개인적 선호에 맞지 않는다는 것은 재구조화의 타당한 이유가 되지 않습니다. 이전 프로그래머보다 더 잘할 수 있다고 생각하는 것도 타당한 이유가 아닙니다.

- *새로운 기술은 리팩터링의 충분한 이유가 되지 않습니다.* 리팩터링의 최악의 이유 중 하나는 현재 코드가 오늘날 우리가 가진 모든 멋진 기술보다 너무 뒤처져 있고, 새로운 언어나 프레임워크가 훨씬 더 우아하게 일을 처리할 수 있다고 믿는 것입니다. 비용-편익 분석이 새로운 언어나 프레임워크가 기능성, 유지보수성, 또는 생산성에서 상당한 개선을 가져올 것임을 보여주지 않는다면, 그대로 두는 것이 최선입니다.

- *인간은 실수를 한다는 것을 기억하세요.* 재구조화가 항상 새로운 코드가 더 나을 것 — 또는 심지어 이전 시도만큼 좋을 것 — 을 보장하지는 않습니다. 나는 몇 번의 실패한 재구조화 시도를 보았고 참여했습니다. 아름답지는 않았지만, 그것이 인간적인 것이었습니다.

[Rajith Attapattu](http://programmer.97things.oreilly.com/wiki/index.php/Rajith_Attapattu)가 작성함.